{"ast":null,"code":"/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\nimport ReactCurrentBatchConfig from './ReactCurrentBatchConfig';\nimport { enableTransitionTracing } from 'shared/ReactFeatureFlags';\nexport function startTransition(scope, options) {\n  const prevTransition = ReactCurrentBatchConfig.transition;\n  ReactCurrentBatchConfig.transition = {};\n  const currentTransition = ReactCurrentBatchConfig.transition;\n\n  if (__DEV__) {\n    ReactCurrentBatchConfig.transition._updatedFibers = new Set();\n  }\n\n  if (enableTransitionTracing) {\n    if (options !== undefined && options.name !== undefined) {\n      // $FlowFixMe[incompatible-use] found when upgrading Flow\n      ReactCurrentBatchConfig.transition.name = options.name; // $FlowFixMe[incompatible-use] found when upgrading Flow\n\n      ReactCurrentBatchConfig.transition.startTime = -1;\n    }\n  }\n\n  try {\n    scope();\n  } finally {\n    ReactCurrentBatchConfig.transition = prevTransition;\n\n    if (__DEV__) {\n      if (prevTransition === null && currentTransition._updatedFibers) {\n        const updatedFibersCount = currentTransition._updatedFibers.size;\n\n        if (updatedFibersCount > 10) {\n          console.warn('Detected a large number of updates inside startTransition. ' + 'If this is due to a subscription please re-write it to use React provided hooks. ' + 'Otherwise concurrent mode guarantees are off the table.');\n        }\n\n        currentTransition._updatedFibers.clear();\n      }\n    }\n  }\n}","map":{"version":3,"sources":["/Users/bytedance/Desktop/sourceCodeReading/react-code/src/react/packages/react/src/ReactStartTransition.js"],"names":["ReactCurrentBatchConfig","enableTransitionTracing","startTransition","scope","options","prevTransition","transition","currentTransition","__DEV__","_updatedFibers","Set","undefined","name","startTime","updatedFibersCount","size","console","warn","clear"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,OAAOA,uBAAP,MAAoC,2BAApC;AACA,SAAQC,uBAAR,QAAsC,0BAAtC;AAEA,OAAO,SAASC,eAAT,CACLC,KADK,EAELC,OAFK,EAGL;AACA,QAAMC,cAAc,GAAGL,uBAAuB,CAACM,UAA/C;AACAN,EAAAA,uBAAuB,CAACM,UAAxB,GAAqC,EAArC;AACA,QAAMC,iBAAiB,GAAGP,uBAAuB,CAACM,UAAlD;;AAEA,MAAIE,OAAJ,EAAa;AACXR,IAAAA,uBAAuB,CAACM,UAAxB,CAAmCG,cAAnC,GAAoD,IAAIC,GAAJ,EAApD;AACD;;AAED,MAAIT,uBAAJ,EAA6B;AAC3B,QAAIG,OAAO,KAAKO,SAAZ,IAAyBP,OAAO,CAACQ,IAAR,KAAiBD,SAA9C,EAAyD;AACvD;AACAX,MAAAA,uBAAuB,CAACM,UAAxB,CAAmCM,IAAnC,GAA0CR,OAAO,CAACQ,IAAlD,CAFuD,CAGvD;;AACAZ,MAAAA,uBAAuB,CAACM,UAAxB,CAAmCO,SAAnC,GAA+C,CAAC,CAAhD;AACD;AACF;;AAED,MAAI;AACFV,IAAAA,KAAK;AACN,GAFD,SAEU;AACRH,IAAAA,uBAAuB,CAACM,UAAxB,GAAqCD,cAArC;;AAEA,QAAIG,OAAJ,EAAa;AACX,UAAIH,cAAc,KAAK,IAAnB,IAA2BE,iBAAiB,CAACE,cAAjD,EAAiE;AAC/D,cAAMK,kBAAkB,GAAGP,iBAAiB,CAACE,cAAlB,CAAiCM,IAA5D;;AACA,YAAID,kBAAkB,GAAG,EAAzB,EAA6B;AAC3BE,UAAAA,OAAO,CAACC,IAAR,CACE,gEACE,mFADF,GAEE,yDAHJ;AAKD;;AACDV,QAAAA,iBAAiB,CAACE,cAAlB,CAAiCS,KAAjC;AACD;AACF;AACF;AACF","sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\nimport type {StartTransitionOptions} from 'shared/ReactTypes';\n\nimport ReactCurrentBatchConfig from './ReactCurrentBatchConfig';\nimport {enableTransitionTracing} from 'shared/ReactFeatureFlags';\n\nexport function startTransition(\n  scope: () => void,\n  options?: StartTransitionOptions,\n) {\n  const prevTransition = ReactCurrentBatchConfig.transition;\n  ReactCurrentBatchConfig.transition = {};\n  const currentTransition = ReactCurrentBatchConfig.transition;\n\n  if (__DEV__) {\n    ReactCurrentBatchConfig.transition._updatedFibers = new Set();\n  }\n\n  if (enableTransitionTracing) {\n    if (options !== undefined && options.name !== undefined) {\n      // $FlowFixMe[incompatible-use] found when upgrading Flow\n      ReactCurrentBatchConfig.transition.name = options.name;\n      // $FlowFixMe[incompatible-use] found when upgrading Flow\n      ReactCurrentBatchConfig.transition.startTime = -1;\n    }\n  }\n\n  try {\n    scope();\n  } finally {\n    ReactCurrentBatchConfig.transition = prevTransition;\n\n    if (__DEV__) {\n      if (prevTransition === null && currentTransition._updatedFibers) {\n        const updatedFibersCount = currentTransition._updatedFibers.size;\n        if (updatedFibersCount > 10) {\n          console.warn(\n            'Detected a large number of updates inside startTransition. ' +\n              'If this is due to a subscription please re-write it to use React provided hooks. ' +\n              'Otherwise concurrent mode guarantees are off the table.',\n          );\n        }\n        currentTransition._updatedFibers.clear();\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}